(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var i=e.g.document;if(!t&&i&&(i.currentScript&&(t=i.currentScript.src),!t)){var r=i.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=1,i=2,r=e.p+"2dbd01ce16c0fa83cb67.png";class l extends class{constructor(e){let{row:t,column:r}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;this.row=t,this.column=r,this.state=l}changeState(e){this.state=e}activate(){throw new Error('"activate" not implement')}deactivate(){throw new Error('"deactivate" not implement')}click(){throw new Error('"click" not implement')}render(e){throw new Error('"render" not implement')}}{constructor(e){let{row:t,column:l}=e;super({row:t,column:l},arguments.length>1&&void 0!==arguments[1]?arguments[1]:i),this.el=document.createElement("div"),this.el.dataset.row=t,this.el.dataset.column=l,this.el.classList.add("cell"),this.el.innerHTML=`<img src="${r}">`,this.deactivate()}click(){this.state===t&&(this.deactivate(),this.el.classList.add("cell-target-defeat"),setTimeout((()=>{this.el.classList.remove("cell-target-defeat")}),500))}deactivate(){this.el.classList.remove("cell-target"),this.el.querySelector("img").classList.add("hide"),this.changeState(i)}activate(){this.el.classList.add("cell-target"),this.el.querySelector("img").classList.remove("hide"),this.changeState(t)}render(e){e.insertAdjacentElement("beforeEnd",this.el)}}function n(e,t){return Math.round(e-.5+Math.random()*(t-e))}function o(e,t){return[...e].sort(((e,i)=>isNaN(Number(e[t]))?e[t]>i[t]?-1:1:e[t]-i[t]))}class s{constructor(e){this.gameField=e,this.activeCellPosition=null,this.setListeners()}setListeners(){this.gameField.addClickListener((e=>{const{target:t}=e,i=t.closest(".cell");if(!i)return;const r={row:Number(i.dataset.row),column:Number(i.dataset.column)};this.gameField.clickCell(r)}))}start(){this.gameField.render(document.querySelector(".task-field")),setInterval((()=>{const e={row:n(0,this.gameField.rowCount),column:n(0,this.gameField.columnCount)};for(;this.activeCellPosition&&e.row===this.activeCellPosition.row&&e.column===this.activeCellPosition.column;)e.row=n(0,this.gameField.rowCount),e.column=n(0,this.gameField.columnCount);this.changeActiveCell(e)}),2e3)}changeActiveCell(e){this.activeCellPosition&&this.gameField.deactivate(this.activeCellPosition),this.gameField.activate(e),this.activeCellPosition=e}}class c extends class{constructor(e,t,i){this.columnCount=t,this.rowCount=e,this.CellClass=i,this.field=null,this.init()}checkFieldBoundary(e){let{column:t,row:i}=e;if(i>=this.field.length||t>=this.field[i].length||t<0||i<0)throw new Error("out of field bound")}init(){this.field=Array(this.rowCount).fill(0).map(((e,t)=>Array(this.columnCount).fill(0).map(((e,i)=>new this.CellClass({row:t,column:i})))))}clickCell(e){let{column:t,row:i}=e;throw new Error('"clickCell" not implement')}activate(e){let{column:t,row:i}=e;throw new Error('"activate" not implement')}deactivate(e){let{column:t,row:i}=e;throw new Error('"deactivate" not implement')}render(e){throw new Error('"render" not implement')}}{constructor(e,t,i){super(e,t,i),this.el=document.createElement("div"),this.el.classList.add("game-field")}activate(e){let{column:t,row:i}=e;this.checkFieldBoundary({column:t,row:i}),this.field[i][t].activate()}deactivate(e){let{column:t,row:i}=e;this.checkFieldBoundary({column:t,row:i}),this.field[i][t].deactivate()}clickCell(e){let{column:t,row:i}=e;this.checkFieldBoundary({column:t,row:i}),this.field[i][t].click()}addClickListener(e){this.el.addEventListener("click",e)}render(e){e.append(this.el),this.field.forEach((e=>{e.forEach((e=>{e.render(this.el)}))}))}}class a extends class{constructor(e,t){this.films=e,this.filmAttributes=t}recreateTable(e){throw new Error('"recreateTable" not implement')}render(e){throw new Error('"render" not implement')}}{constructor(e,t,i){super(e,t),this.el=null,this.recreateTable(e,i)}recreateTable(e,t){const i=this.el?this.el.parentNode:null;this.el&&this.el.remove(),this.films=e,this.el=document.createElement("table"),this.generateTable(t),i&&this.render(i)}generateTable(e){const t=this.filmAttributes.map((t=>`<th class="table-cell">${t===e?`${t} ↓`:t}</th>`));this.el.innerHTML=`\n    <caption>Фильмы</caption>\n    <thead><tr> ${t.join("")}</tr></thead>\n    <tbody></tbody>`;const i=this.el.querySelector("tbody");this.films.forEach((e=>{i.insertAdjacentElement("beforeEnd",this.filmToTableRow(e))}))}filmToTableRow(e){const t=document.createElement("tr");this.filmAttributes.forEach((i=>{t.dataset[i]=e[i]}));const i=this.filmAttributes.map((t=>`<td class="table-cell">${e[t]}</td>`));return t.insertAdjacentHTML("beforeEnd",`<tr>${i.join("")}</tr>`),t}render(e){e.insertAdjacentElement("beforeEnd",this.el)}}let d=null;const h=["id","title","year","imdb"],m=[{id:26,title:"Побег из Шоушенка",imdb:9.3,year:1994},{id:25,title:"Крёстный отец",imdb:9.2,year:1972},{id:27,title:"Крёстный отец 2",imdb:9,year:1974},{id:1047,title:"Тёмный рыцарь",imdb:9,year:2008},{id:223,title:"Криминальное чтиво",imdb:8.9,year:1994}];let u=0;function w(e,t){const i=document.querySelector(".controls"),r=document.querySelector(".task-field"),l=document.createElement("button");l.classList.add("control"),l.textContent=`Таблица фильмов (#${t})`,i.insertAdjacentElement("beforeEnd",l),l.addEventListener("click",(()=>{clearInterval(d),r.innerHTML="",u=0;const t=o(m,h[u]),i=new a(t,h,h[u]);i.render(r),d=setInterval((()=>{const t=e(i);i.recreateTable(t,h[u])}),2e3)}))}!function(){const e=document.querySelector(".controls"),t=document.querySelector(".task-field"),i=document.createElement("button");i.classList.add("control"),i.textContent="Убийца гоблинов (#1)",e.insertAdjacentElement("beforeEnd",i),i.addEventListener("click",(()=>{t.innerHTML="";const e=new c(4,4,l);new s(e).start()}))}(),w((e=>{u=(u+1)%h.length;const t=e.el.querySelector("tbody").querySelectorAll("tr");let i=[];return t.forEach((e=>{i.push({...e.dataset})})),i=o(i,h[u]),i}),2),w((e=>(u=(u+1)%h.length,o(e.films,h[u]))),3)})();